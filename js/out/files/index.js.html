<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>index.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/fan1xia.Failed.html">fan1xia.Failed</a></li>
            
                <li><a href="../classes/fan1xia.Failed.prototype.html">fan1xia.Failed.prototype</a></li>
            
                <li><a href="../classes/fan1xia.Index.html">fan1xia.Index</a></li>
            
                <li><a href="../classes/fan1xia.Index.prototype.html">fan1xia.Index.prototype</a></li>
            
                <li><a href="../classes/fan1xia.model.Canvas.html">fan1xia.model.Canvas</a></li>
            
                <li><a href="../classes/fan1xia.model.Canvas.prototype.html">fan1xia.model.Canvas.prototype</a></li>
            
                <li><a href="../classes/fan1xia.model.Images.html">fan1xia.model.Images</a></li>
            
                <li><a href="../classes/fan1xia.model.Images.prototype.html">fan1xia.model.Images.prototype</a></li>
            
                <li><a href="../classes/fan1xia.model.Score.html">fan1xia.model.Score</a></li>
            
                <li><a href="../classes/fan1xia.model.Score.prototype.html">fan1xia.model.Score.prototype</a></li>
            
                <li><a href="../classes/fan1xia.model.StorageModel.html">fan1xia.model.StorageModel</a></li>
            
                <li><a href="../classes/fan1xia.model.StorageModel.prototype.html">fan1xia.model.StorageModel.prototype</a></li>
            
                <li><a href="../classes/fan1xia.model.Store.html">fan1xia.model.Store</a></li>
            
                <li><a href="../classes/fan1xia.model.Store.prototype.html">fan1xia.model.Store.prototype</a></li>
            
                <li><a href="../classes/fan1xia.model.Timer.html">fan1xia.model.Timer</a></li>
            
                <li><a href="../classes/fan1xia.model.Timer.prototype.html">fan1xia.model.Timer.prototype</a></li>
            
                <li><a href="../classes/fan1xia.Success.html">fan1xia.Success</a></li>
            
                <li><a href="../classes/fan1xia.Success.prototype.html">fan1xia.Success.prototype</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/canvasModel.html">canvasModel</a></li>
            
                <li><a href="../modules/imagesModel.html">imagesModel</a></li>
            
                <li><a href="../modules/index.html">index</a></li>
            
                <li><a href="../modules/storageModel.html">storageModel</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: index.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/** 
* Index js主页js
*
* @module index
* @main index
* @namespace fan1xia
* @author 颜海镜
* @version 2012-09-29 15:20:04
*/
(function($, window){
    &#x27;use strict&#x27;;
	var Index,
		Home,
		Success,
		Failed;
	/**
	* 主页类
	* @class Index
	* @constructor
	* @extends fan1xia.Index.prototype	
	*/
	Index = function(){
	    /**
         * 级别属性存储当前级别与系统级别的索引
         * @property levels
         * @type Array
         * @default []
         */
		this.levels = [];
	};
	
	/**
	* Index构造函数的原型对象
	* @class Index.prototype
	* @static
	*/
	Index.prototype = {
		/**
		 * 初始化
		 * @method init 
		 */
		init:function(){
			var canvas = new window.fan1xia.model.Canvas(),
			success = new Success(),
			failed = new Failed();
			
			window.fan1xia.canvas = canvas;//更新画布
			this.bindClickEvent();//初始化点击事件
			canvas.init();
			
			success.init();
			failed.init();
			window.fan1xia.levels = [{level:2, grad:2},
                        {level:4, grad:4},
                        {level:4, grad:2},
                        {level:6, grad:6},  
                        {level:6, grad:4},
                        {level:6, grad:2},
                        {level:8, grad:16},
                        {level:8, grad:8},
                        {level:8, grad:4},
                        {level:8, grad:2}
                ];
		},
		/**
		 * 绑定点击事件
		 * @event bindClickEvent
		 */
		bindClickEvent:function(){
			var that = this;
			//绑定开始界面的事件
			$(&#x27;#home&#x27;).delegate(&#x27;button&#x27;, &#x27;click&#x27;, function(e){
				var
					level = parseInt($(this).html(), 10) - 1,
					canvas = window.fan1xia.canvas,
					callback = function(){},
					levels = [];
					
				levels = window.fan1xia.levels;
				//添加点击效果
				window.fan1xia.currentLevel = level;
				$(this).addClass(&#x27;click&#x27;);
				//刷新完成回调函数
				callback = function(){
					//刷新画布
					canvas.refresh(levels[level].level, levels[level].grad);
				};
				//旋转出元素
				$(&#x27;#home&#x27;).rotate3Di(90, 500, {complete:function(){
					$(this).hide(0, function(){
						$(&#x27;#wrap&#x27;).show(0, function(){
							$(this).rotate3Di(-90);
							$(&#x27;#wrap&#x27;).rotate3Di(0, 1000, {complete:function(){callback();}});
						});
					});
				}});
			});
		}
	};
	
	/**
    * 成功类
    * @class Success
    * @constructor
    * @extends fan1xia.Success.prototype
    */
    Success = function(){
    };
    
	/**
    * 成功类原型
    * @class Success.prototype
    * @static
    */
	Success.prototype = {
	    /**
         * 初始化
         * @method init 
         */
		init:function(){
			this.bindClickEvent();
		},		
		
		/**
		 * 胜利处理结果
		 * @method success 
		 */
		success:function(){
		    var 
		      canvas = window.fan1xia.canvas,
		      score = canvas.score,
		      total = score.totalPairs,
		      error = score.errorCount,
		      click = score.clickCount,
		      scoreNum = parseInt(2*total*100/click, 10),
		      $success = $(&#x27;#success&#x27;),
		      $pair = $(&quot;#pair strong&quot;, $success),
		      $click = $(&quot;#click strong&quot;, $success),
		      $error = $(&quot;#error strong&quot;, $success),
		      $score = $(&quot;#score strong&quot;, $success),
		      $hightScore = $(&quot;#hight-score strong&quot;, $success),
		      $level = $(&quot;#level strong&quot;, $success),
		      level = window.fan1xia.currentLevel,
		      storage = new window.fan1xia.model.StorageModel(),
		      key = &quot;fan1xiaHightScoreLevel&quot; + level, 
		      hightScore;
		    
		    storage.init();//初始化存储		    
		    hightScore = storage.load(key) || 0;
		    
		    if(scoreNum &gt;= hightScore){
		        storage.save(key, scoreNum);
		    }
		    $pair.html(total);
		    $click.html(click);
		    $error.html(error);
		    $score.html(scoreNum);
		    $hightScore.html(hightScore);
		    $level.html(level + 1);
		    
		    //添加QQ分享
		    (function(){
                var p = {
                    url:location.href, /*获取URL，可加上来自分享到QQ标识，方便统计*/
                    desc:&#x27;哈哈！！！我在难度&#x27; + level+1 + &#x27;中，得了&#x27; + scoreNum + &#x27;分，您是否能找到板上所有的匹配？翻转一块墙砖会显示一张图片，然后尝试在其他地方找到其匹配。记住图片的位置，因为如果翻转的墙砖上的图片不匹配，您将必须重试。匹配所有图片才能获胜。&#x27;, /*分享理由(风格应模拟用户对话),支持多分享语随机展现（使用|分隔）*/
                    title:&#x27;翻一下&#x27;, /*分享标题(可选)*/
                    summary:&#x27;翻一下是一款类似小丑配对的游戏，能增加记忆力&#x27;, /*分享摘要(可选)*/
                    pics:&#x27;http://yanhaijing.github.io/fan1xia/images/fan.gif&#x27;, /*分享图片(可选)*/
                    site:&#x27;https://github.com/yanhaijing&#x27;, /*分享来源(可选) 如：QQ分享*/
                    style:&#x27;101&#x27;,
                    width:96,
                    height:24
                };
                var s = [];
                for(var i in p){
                    s.push(i + &#x27;=&#x27; + encodeURIComponent(p[i]||&#x27;&#x27;));
                }
                $(&quot;#share-qzone-success&quot;).attr(&quot;href&quot;, &quot;http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?&quot; + s.join(&#x27;&amp;&#x27;));
            })();

			//旋转出元素
			$(&#x27;#wrap&#x27;).rotate3Di(-90, 500, {complete:function(){
				$(this).hide(0, function(){
					$success.show(0, function(){
						$(this).rotate3Di(90);
						$success.rotate3Di(0, 1000, {complete:function(){}});
					});
				});
			}});
		},
		
		/**
         * 绑定点击事件
         * @event bindClickEvent 
         */
		bindClickEvent:function(){
			//绑定再试一次事件
			var $success = $(&#x27;#success&#x27;);
			//绑定返回home事件
			$success.delegate(&#x27;.go-home&#x27;, &#x27;click&#x27;, function(e){
				//旋转出元素
				$(&#x27;#success&#x27;).rotate3Di(90, 500, {complete:function(){
					$(this).hide(0, function(){
						$(&#x27;#home&#x27;).show(0, function(){
							$(this).rotate3Di(-90);
							$(&#x27;#home&#x27;).rotate3Di(0, 1000, {complete:function(){}});
						});
					});
				}});
			});
			
			//绑定再试一次事件
			$success.delegate(&#x27;.try-again&#x27;, &#x27;click&#x27;, function(e){
				var
					level = window.fan1xia.currentLevel,
					canvas = window.fan1xia.canvas,
					callback = function(){},
					levels = [];
					
				levels = window.fan1xia.levels;
				//刷新完成回调函数
				callback = function(){
					//刷新画布
					canvas.refresh(levels[level].level, levels[level].grad);
				};
				//旋转出元素
				$(&#x27;#success&#x27;).rotate3Di(90, 500, {complete:function(){
					$(this).hide(0, function(){
						$(&#x27;#wrap&#x27;).show(0, function(){
							$(this).rotate3Di(-90);
							$(&#x27;#wrap&#x27;).rotate3Di(0, 1000, {complete:function(){callback();}});
						});
					});
				}});
			});
		}
	};
	
	/**
    * 失败类
    * @class Failed
    * @constructor
    * @extends fan1xia.Failed.prototype
    */
    Failed = function(){
    };
    
	/**
    * 失败类原型
    * @class Failed.prototype
    * @static
    */
	Failed.prototype = {
	    /**
         * 初始化
         * @method init 
         */
		init:function(){
			this.bindClickEvent();
		},
		
		/**
		 * 失败处理结果
		 * @method fail 
		 */
		fail:function(){
			//旋转出元素
				$(&#x27;#wrap&#x27;).rotate3Di(-90, 500, {complete:function(){
					$(this).hide(0, function(){
						$(&#x27;#failed&#x27;).show(0, function(){
							$(this).rotate3Di(90);
							$(&#x27;#failed&#x27;).rotate3Di(0, 1000, {complete:function(){}});
						});
					});
				}});
		},
		
		/**
         * 绑定点击事件
         * @event bindClickEvent
         */
		bindClickEvent:function(){
			//绑定再试一次事件
			var $failed = $(&#x27;#failed&#x27;);
			//绑定返回home事件
			$failed.delegate(&#x27;.go-home&#x27;, &#x27;click&#x27;, function(e){
				//旋转出元素
				$(&#x27;#failed&#x27;).rotate3Di(90, 500, {complete:function(){
					$(this).hide(0, function(){
						$(&#x27;#home&#x27;).show(0, function(){
							$(this).rotate3Di(-90);
							$(&#x27;#home&#x27;).rotate3Di(0, 1000, {complete:function(){}});
						});
					});
				}});
			});
			
			//绑定再试一次事件
			$failed.delegate(&#x27;.try-again&#x27;, &#x27;click&#x27;, function(e){
				var
					level = window.fan1xia.currentLevel,
					canvas = window.fan1xia.canvas,
					callback = function(){},
					levels = window.fan1xia.levels;
					
				//刷新完成回调函数
				callback = function(){
					//刷新画布
					canvas.refresh(levels[level].level, levels[level].grad);
				};
				//旋转出元素
				$(&#x27;#failed&#x27;).rotate3Di(90, 500, {complete:function(){
					$(this).hide(0, function(){
						$(&#x27;#wrap&#x27;).show(0, function(){
							$(this).rotate3Di(-90);
							$(&#x27;#wrap&#x27;).rotate3Di(0, 1000, {complete:function(){callback();}});
						});
					});
				}});
			});
		}
	};
	
	window.fan1xia = window.fan1xia || {};
    window.fan1xia.Failed = Failed;
    window.fan1xia.Success = Success;
	$(function(){
		var index = new Index();
		index.init();
	})
}(jQuery, window));

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
